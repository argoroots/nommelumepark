<!DOCTYPE html>
<html ng-app="lumeparkApp">
  <head>
    <title>Nõmme Lumepark</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-route.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-resource.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <style>body{padding-top:70px}.fa-spin{color:#777}.form-control-feedback{color:#ccc}</style>
    <script>!function(){function a(){}function b(a){return a}function c(a){return!!a}function d(a){return!a}function e(a){return function(){if(null===a)throw new Error("Callback was already called.");a.apply(this,arguments),a=null}}function f(a){return function(){null!==a&&(a.apply(this,arguments),a=null)}}function g(a){return K(a)||"number"==typeof a.length&&a.length>=0&&a.length%1===0}function h(a,b){for(var c=-1,d=a.length;++c<d;)b(a[c],c,a)}function i(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function j(a){return i(Array(a),function(a,b){return b})}function k(a,b,c){return h(a,function(a,d,e){c=b(c,a,d,e)}),c}function l(a,b){h(M(a),function(c){b(a[c],c)})}function m(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}function n(a){var b,c,d=-1;return g(a)?(b=a.length,function(){return d++,b>d?d:null}):(c=M(a),b=c.length,function(){return d++,b>d?c[d]:null})}function o(a,b){return b=null==b?a.length-1:+b,function(){for(var c=Math.max(arguments.length-b,0),d=Array(c),e=0;c>e;e++)d[e]=arguments[e+b];switch(b){case 0:return a.call(this,d);case 1:return a.call(this,arguments[0],d)}}}function p(a){return function(b,c,d){return a(b,d)}}function q(b){return function(c,d,g){g=f(g||a),c=c||[];var h=n(c);if(0>=b)return g(null);var i=!1,j=0,k=!1;!function l(){if(i&&0>=j)return g(null);for(;b>j&&!k;){var a=h();if(null===a)return i=!0,void(0>=j&&g(null));j+=1,d(c[a],a,e(function(a){j-=1,a?(g(a),k=!0):l()}))}}()}}function r(a){return function(b,c,d){return a(H.eachOf,b,c,d)}}function s(a){return function(b,c,d,e){return a(q(c),b,d,e)}}function t(a){return function(b,c,d){return a(H.eachOfSeries,b,c,d)}}function u(b,c,d,e){e=f(e||a),c=c||[];var h=g(c)?[]:{};b(c,function(a,b,c){d(a,function(a,d){h[b]=d,c(a)})},function(a){e(a,h)})}function v(a,b,c,d){var e=[];a(b,function(a,b,d){c(a,function(c){c&&e.push({index:b,value:a}),d()})},function(){d(i(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})}function w(a,b,c,d){v(a,b,function(a,b){c(a,function(a){b(!a)})},d)}function x(a,b,c){return function(d,e,f,g){function h(){g&&g(c(!1,void 0))}function i(a,d,e){return g?void f(a,function(d){g&&b(d)&&(g(c(!0,a)),g=f=!1),e()}):e()}arguments.length>3?a(d,e,i,h):(g=f,f=e,a(d,i,h))}}function y(a,b){return b}function z(b,c,d){d=d||a;var e=g(c)?[]:{};b(c,function(a,b,c){a(o(function(a,d){d.length<=1&&(d=d[0]),e[b]=d,c(a)}))},function(a){d(a,e)})}function A(a,b,c,d){var e=[];a(b,function(a,b,d){c(a,function(a,b){e=e.concat(b||[]),d(a)})},function(a){d(a,e)})}function B(b,c,d){function f(b,c,d,e){if(null!=e&&"function"!=typeof e)throw new Error("task callback must be a function");return b.started=!0,K(c)||(c=[c]),0===c.length&&b.idle()?H.setImmediate(function(){b.drain()}):(h(c,function(c){var f={data:c,callback:e||a};d?b.tasks.unshift(f):b.tasks.push(f),b.tasks.length===b.concurrency&&b.saturated()}),void H.setImmediate(b.process))}function g(a,b){return function(){j-=1;var c=!1,d=arguments;h(b,function(a){h(k,function(b,d){b!==a||c||(k.splice(d,1),c=!0)}),a.callback.apply(a,d)}),a.tasks.length+j===0&&a.drain(),a.process()}}if(null==c)c=1;else if(0===c)throw new Error("Concurrency must not be zero");var j=0,k=[],l={tasks:[],concurrency:c,payload:d,saturated:a,empty:a,drain:a,started:!1,paused:!1,push:function(a,b){f(l,a,!1,b)},kill:function(){l.drain=a,l.tasks=[]},unshift:function(a,b){f(l,a,!0,b)},process:function(){if(!l.paused&&j<l.concurrency&&l.tasks.length)for(;j<l.concurrency&&l.tasks.length;){var a=l.payload?l.tasks.splice(0,l.payload):l.tasks.splice(0,l.tasks.length),c=i(a,function(a){return a.data});0===l.tasks.length&&l.empty(),j+=1,k.push(a[0]);var d=e(g(l,a));b(c,d)}},length:function(){return l.tasks.length},running:function(){return j},workersList:function(){return k},idle:function(){return l.tasks.length+j===0},pause:function(){l.paused=!0},resume:function(){if(l.paused!==!1){l.paused=!1;for(var a=Math.min(l.concurrency,l.tasks.length),b=1;a>=b;b++)H.setImmediate(l.process)}}};return l}function C(a){return o(function(b,c){b.apply(null,c.concat([o(function(b,c){"object"==typeof console&&(b?console.error&&console.error(b):console[a]&&h(c,function(b){console[a](b)}))})]))})}function D(a){return function(b,c,d){a(j(b),c,d)}}function E(a){return o(function(b,c){var d=o(function(c){var d=this,e=c.pop();return a(b,function(a,b,e){a.apply(d,c.concat([e]))},e)});return c.length?d.apply(this,c):d})}function F(a){return o(function(b){var c=b.pop();b.push(function(){var a=arguments;d?H.setImmediate(function(){c.apply(null,a)}):c.apply(null,a)});var d=!0;a.apply(this,b),d=!1})}var G,H={},I="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;null!=I&&(G=I.async),H.noConflict=function(){return I.async=G,H};var J=Object.prototype.toString,K=Array.isArray||function(a){return"[object Array]"===J.call(a)},L=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},M=Object.keys||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},N="function"==typeof setImmediate&&setImmediate,O=N?function(a){N(a)}:function(a){setTimeout(a,0)};"object"==typeof process&&"function"==typeof process.nextTick?H.nextTick=process.nextTick:H.nextTick=O,H.setImmediate=N?O:H.nextTick,H.forEach=H.each=function(a,b,c){return H.eachOf(a,p(b),c)},H.forEachSeries=H.eachSeries=function(a,b,c){return H.eachOfSeries(a,p(b),c)},H.forEachLimit=H.eachLimit=function(a,b,c,d){return q(b)(a,p(c),d)},H.forEachOf=H.eachOf=function(b,c,d){function g(a){j--,a?d(a):null===h&&0>=j&&d(null)}d=f(d||a),b=b||[];for(var h,i=n(b),j=0;null!=(h=i());)j+=1,c(b[h],h,e(g));0===j&&d(null)},H.forEachOfSeries=H.eachOfSeries=function(b,c,d){function g(){var a=!0;return null===i?d(null):(c(b[i],i,e(function(b){if(b)d(b);else{if(i=h(),null===i)return d(null);a?H.setImmediate(g):g()}})),void(a=!1))}d=f(d||a),b=b||[];var h=n(b),i=h();g()},H.forEachOfLimit=H.eachOfLimit=function(a,b,c,d){q(b)(a,c,d)},H.map=r(u),H.mapSeries=t(u),H.mapLimit=s(u),H.inject=H.foldl=H.reduce=function(a,b,c,d){H.eachOfSeries(a,function(a,d,e){c(b,a,function(a,c){b=c,e(a)})},function(a){d(a,b)})},H.foldr=H.reduceRight=function(a,c,d,e){var f=i(a,b).reverse();H.reduce(f,c,d,e)},H.transform=function(a,b,c,d){3===arguments.length&&(d=c,c=b,b=K(a)?[]:{}),H.eachOf(a,function(a,d,e){c(b,a,d,e)},function(a){d(a,b)})},H.select=H.filter=r(v),H.selectLimit=H.filterLimit=s(v),H.selectSeries=H.filterSeries=t(v),H.reject=r(w),H.rejectLimit=s(w),H.rejectSeries=t(w),H.any=H.some=x(H.eachOf,c,b),H.someLimit=x(H.eachOfLimit,c,b),H.all=H.every=x(H.eachOf,d,d),H.everyLimit=x(H.eachOfLimit,d,d),H.detect=x(H.eachOf,b,y),H.detectSeries=x(H.eachOfSeries,b,y),H.detectLimit=x(H.eachOfLimit,b,y),H.sortBy=function(a,b,c){function d(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0}H.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){return a?c(a):void c(null,i(b.sort(d),function(a){return a.value}))})},H.auto=function(b,c,d){function e(a){r.unshift(a)}function g(a){var b=m(r,a);b>=0&&r.splice(b,1)}function i(){n--,h(r.slice(0),function(a){a()})}d||(d=c,c=null),d=f(d||a);var j=M(b),n=j.length;if(!n)return d(null);c||(c=n);var p={},q=0,r=[];e(function(){n||d(null,p)}),h(j,function(a){function f(){return c>q&&k(s,function(a,b){return a&&p.hasOwnProperty(b)},!0)&&!p.hasOwnProperty(a)}function h(){f()&&(q++,g(h),n[n.length-1](r,p))}for(var j,n=K(b[a])?b[a]:[b[a]],r=o(function(b,c){if(q--,c.length<=1&&(c=c[0]),b){var e={};l(p,function(a,b){e[b]=a}),e[a]=c,d(b,e)}else p[a]=c,H.setImmediate(i)}),s=n.slice(0,n.length-1),t=s.length;t--;){if(!(j=b[s[t]]))throw new Error("Has inexistant dependency");if(K(j)&&m(j,a)>=0)throw new Error("Has cyclic dependencies")}f()?(q++,n[n.length-1](r,p)):e(h)})},H.retry=function(a,b,c){function d(a,b){if("number"==typeof b)a.times=parseInt(b,10)||f;else{if("object"!=typeof b)throw new Error("Unsupported argument type for 'times': "+typeof b);a.times=parseInt(b.times,10)||f,a.interval=parseInt(b.interval,10)||g}}function e(a,b){function c(a,c){return function(d){a(function(a,b){d(!a||c,{err:a,result:b})},b)}}function d(a){return function(b){setTimeout(function(){b(null)},a)}}for(;i.times;){var e=!(i.times-=1);h.push(c(i.task,e)),!e&&i.interval>0&&h.push(d(i.interval))}H.series(h,function(b,c){c=c[c.length-1],(a||i.callback)(c.err,c.result)})}var f=5,g=0,h=[],i={times:f,interval:g},j=arguments.length;if(1>j||j>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=j&&"function"==typeof a&&(c=b,b=a),"function"!=typeof a&&d(i,a),i.callback=c,i.task=b,i.callback?e():e},H.waterfall=function(b,c){function d(a){return o(function(b,e){if(b)c.apply(null,[b].concat(e));else{var f=a.next();f?e.push(d(f)):e.push(c),F(a).apply(null,e)}})}if(c=f(c||a),!K(b)){var e=new Error("First argument to waterfall must be an array of functions");return c(e)}return b.length?void d(H.iterator(b))():c()},H.parallel=function(a,b){z(H.eachOf,a,b)},H.parallelLimit=function(a,b,c){z(q(b),a,c)},H.series=function(a,b){z(H.eachOfSeries,a,b)},H.iterator=function(a){function b(c){function d(){return a.length&&a[c].apply(null,arguments),d.next()}return d.next=function(){return c<a.length-1?b(c+1):null},d}return b(0)},H.apply=o(function(a,b){return o(function(c){return a.apply(null,b.concat(c))})}),H.concat=r(A),H.concatSeries=t(A),H.whilst=function(b,c,d){if(d=d||a,b()){var e=o(function(a,f){a?d(a):b.apply(this,f)?c(e):d(null)});c(e)}else d(null)},H.doWhilst=function(a,b,c){var d=0;return H.whilst(function(){return++d<=1||b.apply(this,arguments)},a,c)},H.until=function(a,b,c){return H.whilst(function(){return!a.apply(this,arguments)},b,c)},H.doUntil=function(a,b,c){return H.doWhilst(a,function(){return!b.apply(this,arguments)},c)},H.during=function(b,c,d){d=d||a;var e=o(function(a,c){a?d(a):(c.push(f),b.apply(this,c))}),f=function(a,b){a?d(a):b?c(e):d(null)};b(f)},H.doDuring=function(a,b,c){var d=0;H.during(function(a){d++<1?a(null,!0):b.apply(this,arguments)},a,c)},H.queue=function(a,b){var c=B(function(b,c){a(b[0],c)},b,1);return c},H.priorityQueue=function(b,c){function d(a,b){return a.priority-b.priority}function e(a,b,c){for(var d=-1,e=a.length-1;e>d;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function f(b,c,f,g){if(null!=g&&"function"!=typeof g)throw new Error("task callback must be a function");return b.started=!0,K(c)||(c=[c]),0===c.length?H.setImmediate(function(){b.drain()}):void h(c,function(c){var h={data:c,priority:f,callback:"function"==typeof g?g:a};b.tasks.splice(e(b.tasks,h,d)+1,0,h),b.tasks.length===b.concurrency&&b.saturated(),H.setImmediate(b.process)})}var g=H.queue(b,c);return g.push=function(a,b,c){f(g,a,b,c)},delete g.unshift,g},H.cargo=function(a,b){return B(a,1,b)},H.log=C("log"),H.dir=C("dir"),H.memoize=function(a,c){var d={},e={};c=c||b;var f=o(function(b){var f=b.pop(),g=c.apply(null,b);g in d?H.setImmediate(function(){f.apply(null,d[g])}):g in e?e[g].push(f):(e[g]=[f],a.apply(null,b.concat([o(function(a){d[g]=a;var b=e[g];delete e[g];for(var c=0,f=b.length;f>c;c++)b[c].apply(null,a)})])))});return f.memo=d,f.unmemoized=a,f},H.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},H.times=D(H.map),H.timesSeries=D(H.mapSeries),H.timesLimit=function(a,b,c,d){return H.mapLimit(j(a),b,c,d)},H.seq=function(){var b=arguments;return o(function(c){var d=this,e=c[c.length-1];"function"==typeof e?c.pop():e=a,H.reduce(b,c,function(a,b,c){b.apply(d,a.concat([o(function(a,b){c(a,b)})]))},function(a,b){e.apply(d,[a].concat(b))})})},H.compose=function(){return H.seq.apply(null,Array.prototype.reverse.call(arguments))},H.applyEach=E(H.eachOf),H.applyEachSeries=E(H.eachOfSeries),H.forever=function(b,c){function d(a){return a?f(a):void g(d)}var f=e(c||a),g=F(b);d()},H.ensureAsync=F,H.constant=o(function(a){var b=[null].concat(a);return function(a){return a.apply(this,b)}}),H.wrapSync=H.asyncify=function(a){return o(function(b){var c,d=b.pop();try{c=a.apply(this,b)}catch(e){return d(e)}L(c)&&"function"==typeof c.then?c.then(function(a){d(null,a)})["catch"](function(a){d(a.message?a:new Error(a))}):d(null,c)})},"object"==typeof module&&module.exports?module.exports=H:"function"==typeof define&&define.amd?define([],function(){return H}):I.async=H}();var entuAPI="https://nommelumepark.entu.ee/api2/",entuAPI3="https://auth.entu.ee/",erplyAPI="https://nommelumepark.entu.ee/erply/",cl=function(a){console.log(a)},entu={};entu.getUser=function(a,b,c,d){c.get(entuAPI+"user",{headers:{"X-Auth-UserId":a,"X-Auth-Token":b}}).success(function(a){if(a.result){var b={id:a.result.id,token:a.result.session_key,name:a.result.name};d(null,b)}else d(a)}).error(function(a){d(a)})},entu.getEntities=function(a,b,c,d,e){d.get(entuAPI+"entity",{headers:{"X-Auth-UserId":b,"X-Auth-Token":c},params:a}).success(function(a){a.result!==[]?e(null,a.result):e(a)}).error(function(a){e(a)})},entu.getEntity=function(a,b,c,d,e){d.get(entuAPI+"entity-"+a,{headers:{"X-Auth-UserId":b,"X-Auth-Token":c}}).success(function(a){if(a.result){var b={id:a.result.id,name:a.result.displayname,info:a.result.displayinfo,properties:a.result.properties};e(null,b)}else e(a)}).error(function(a){e(a)})},entu.getChilds=function(a,b,c,d,e){d.get(entuAPI+"entity-"+a+"/childs",{headers:{"X-Auth-UserId":b,"X-Auth-Token":c}}).success(function(a){if(a.result){var b=[];for(var c in a.result)for(var d in a.result[c].entities)b.push(a.result[c].entities[d]);e(null,b)}else e(a)}).error(function(a){e(a)})},entu.getErply=function(a,b,c,d,e,f){e.get(erplyAPI+a,{headers:{"X-Auth-UserId":c,"X-Auth-Token":d},params:b}).success(function(a){a.records?f(null,a.records):f(a)}).error(function(a){f(a)})},angular.module("lumeparkApp",["ngRoute"]).config(["$locationProvider","$routeProvider",function(a,b){a.html5Mode(!1),b.when("/",{templateUrl:"start",controller:"startCtrl"}).when("/login",{templateUrl:"start",controller:"loginCtrl"}).when("/auth",{templateUrl:"start",controller:"authCtrl"}).when("/logout",{templateUrl:"start",controller:"logoutCtrl"}).when("/lendings/:filter",{templateUrl:"lendings",controller:"lendingsCtrl"}).when("/lending/:id",{templateUrl:"lending",controller:"lendingCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location",function(a,b){}]).controller("startCtrl",["$rootScope","$http","$window",function(a,b,c){a.loading=!0,a.activeMenu=null,a.entuUrl=entuAPI,entu.getUser(c.sessionStorage.getItem("user_id"),c.sessionStorage.getItem("user_token"),b,function(b,c){b?a.user=null:a.user=c,a.loading=!1})}]).controller("loginCtrl",["$http","$location","$window",function(a,b,c){var d="1234567890abcdef";c.sessionStorage.clear(),c.sessionStorage.setItem("state",d),a.post(entuAPI+"user/auth",{state:d,redirect_url:b.protocol()+"://"+location.host+"/#/auth"}).success(function(a){c.sessionStorage.setItem("auth_url",a.result.auth_url),c.location.href=a.result.auth_url}).error(function(a){cl(a)})}]).controller("authCtrl",["$http","$window",function(a,b){var c=b.sessionStorage.getItem("auth_url"),d=b.sessionStorage.getItem("state");a.post(c,{state:d}).success(function(a){b.sessionStorage.clear(),b.sessionStorage.setItem("user_id",a.result.user.id),b.sessionStorage.setItem("user_token",a.result.user.session_key),b.location.href="/"}).error(function(a){cl(a)})}]).controller("logoutCtrl",["$rootScope","$location","$window",function(a,b,c){c.sessionStorage.clear(),a.user=null,c.location.href=entuAPI3+"exit?next="+b.protocol()+"://"+location.host}]).controller("lendingsCtrl",["$scope","$rootScope","$http","$routeParams","$window",function(a,b,c,d,e){b.loading=!0,b.activeMenu=d.filter,async.waterfall([function(a){entu.getUser(e.sessionStorage.getItem("user_id"),e.sessionStorage.getItem("user_token"),c,function(c,d){c?(b.user=null,a(c)):(b.user=d,a())})},function(a){entu.getEntities({definition:"laenutus"},b.user.id,b.user.token,c,function(b,c){b?a(b):a(null,c)})},function(e,f){a.lendings=[],async.each(e,function(e){entu.getEntity(e.id,b.user.id,b.user.token,c,function(b,c){b?f(b):(c.status=c.properties.staatus.values?c.properties.staatus.values[0].db_value:"archive",d.filter&&d.filter!==c.status||a.lendings.push(c),f())})},f)}],function(a){a&&cl(a),b.loading=!1})}]).controller("lendingCtrl",["$scope","$rootScope","$http","$routeParams","$window",function(a,b,c,d,e){b.loading=!0,async.series([function(a){entu.getUser(e.sessionStorage.getItem("user_id"),e.sessionStorage.getItem("user_token"),c,function(c,d){c?(b.user=null,a(c)):(b.user=d,a())})},function(e){async.parallel([function(e){entu.getEntity(d.id,b.user.id,b.user.token,c,function(b,c){b?e(b):(a.lending=c,e())})},function(e){async.waterfall([function(a){entu.getChilds(d.id,b.user.id,b.user.token,c,function(b,c){b?a(b):a(null,c)})},function(d,e){a.lendingRows=[],async.each(d,function(d){entu.getEntity(d.id,b.user.id,b.user.token,c,function(b,c){b?e(b):(a.lendingRows.push(c),e())})},e)}],e)},function(d){entu.getErply("getCustomers",{recordsOnPage:1e3},b.user.id,b.user.token,c,function(b,c){b?d(b):(a.customers=[],async.each(c,function(b){a.customers.push({id:b.customerID,name:b.fullName.trim()})},d))})},function(d){entu.getErply("getProducts",{groupID:3,recordsOnPage:1e3},b.user.id,b.user.token,c,function(b,c){b?d(b):(a.prices=[],async.each(c,function(b){a.prices.push({id:b.productID,name:b.name.trim()})},d))})}],e)}],function(a){a&&cl(a),b.loading=!1})}]);</script>
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <div type="button" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false" class="button navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></div><a href="#" class="navbar-brand">Nõmme Lumepark</a>
          <p ng-if="user" class="navbar-text">{{ user.name }}</p>
        </div>
        <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse">
          <ul ng-if="user" class="nav navbar-nav navbar-right">
            <li ng-class="{ active: activeMenu === &quot;bron&quot; }"><a href="/#/lendings/bron">Broneeringud</a></li>
            <li ng-class="{ active: activeMenu === &quot;out&quot; }"><a href="/#/lendings/out">Rendis</a></li>
            <li><a href="/#/logout"><i class="fa fa-sign-out"></i></a></li>
          </ul>
          <ul ng-if="!user" class="nav navbar-nav navbar-right">
            <li><a href="/#/login"><i class="fa fa-sign-in"></i></a></li>
          </ul>
          <ul ng-if="loading" class="nav navbar-nav navbar-right">
            <li class="navbar-text"><i class="fa fa-spinner fa-spin"></i></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div ng-view></div>
      <script type="text/ng-template" id="start"></script>
      <script type="text/ng-template" id="lendings">
        <form class="row">
          <div class="col-xs-12 col-sm-6 col-sm-offset-3">
            <div class="form-group has-feedback">
              <input type="search" ng-model="search" class="form-control"><span aria-hidden="true" class="glyphicon glyphicon-search form-control-feedback"></span>
            </div>
          </div>
        </form>
        <div ng-if="lendings" class="row">
          <table class="table col-xs-12">
            <tbody>
              <tr ng-repeat="lending in lendings | filter : search | orderBy : &quot;status&quot; : true">
                <th><a ng-href="/#/lending/{{ lending.id }}">{{ lending.name }}</a></th>
                <td>{{ lending.info }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </script>
      <script type="text/ng-template" id="lending">
        <ion-view title="{{ entities.title }}">
          <ion-nav-page>
            <ion-content padding="true" has-bouncing="false">
              <ion-list class="card">
                <label class="item item-input item-select"><span class="input-label">Klient</span>
                  <select>
                    <option></option>
                    <option ng-repeat="c in customers | orderBy : &quot;name&quot; ">{{ c.name }}</option>
                  </select>
                </label>
                <label class="item item-input item-select"><span class="input-label">Hind</span>
                  <select>
                    <option></option>
                    <option ng-repeat="p in prices | orderBy : &quot;name&quot; ">{{ p.name }}</option>
                  </select>
                </label>
                <label class="item item-input"><span class="input-label">ERPLY viide</span>
                  <input type="text" disabled>
                </label>
                <label class="item item-input"><span class="input-label">Märkused</span>
                  <input type="text">
                </label>
              </ion-list>
              <ion-list class="card">
                <label class="item item-input"><span class="input-label">Broneeringu algus</span>
                  <input type="datetime">
                </label>
                <label class="item item-input"><span class="input-label">Broneeringu lõpp</span>
                  <input type="datetime">
                </label>
                <label class="item item-input"><span class="input-label">Laenutuse algus</span>
                  <input type="datetime">
                </label>
                <label class="item item-input"><span class="input-label">Laenutuse lõpp</span>
                  <input type="datetime">
                </label>
              </ion-list>
              <ion-list class="card">
                <ion-item ng-repeat="entity in entities.result | filter : query | orderBy : &quot;status&quot; : true" class="item-icon-left item-icon-right"><i ang-show="entity.status === &quot;out&quot;" title="Väljas" class="icon assertive ion-ios-timer-outline"></i>
                  <h2>{{ entity.name }}</h2>
                  <p>{{ entity.info }} &nbsp;</p><i class="icon ion-ios-arrow-right icon-accessory"></i>
                </ion-item>
              </ion-list>
              <div class="row"><a class="button button-outline button-balanced col">Tagasta kõik</a>
                <div class="col"></div><a id="do-scan" ng-if="preferences.p2sMode" href="p2spro://scan?callback=javascript:angular.element(document.getElementById(&quot;do-scan&quot;)).scope().scanCode(&quot;CODE&quot;)" class="button button-outline button-stable col">Lisa toode</a><a id="do-scan" ng-if="!preferences.p2sMode" ng-click="scanCode()" class="button button-outline button-stable col">Lisa toode</a>
              </div>
            </ion-content>
          </ion-nav-page>
        </ion-view>
      </script>
    </div>
  </body>
</html>